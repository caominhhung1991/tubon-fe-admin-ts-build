(this["webpackJsonptu-bon"]=this["webpackJsonptu-bon"]||[]).push([[18],{687:function(n,e,t){"use strict";t(0);var a=t(429),c=t(15),i=a.a.Summary,o=i.Row,r=i.Cell;e.a=function(n){var e,t=n.columns,a=n.dataSource;return Object(c.b)(o,{children:null===t||void 0===t||null===(e=t.map)||void 0===e?void 0:e.call(t,(function(n,e){var t=null===n||void 0===n?void 0:n.id,i=(null===n||void 0===n?void 0:n.colSpan)||0,o=(null===n||void 0===n?void 0:n.cellClassName)||"",u=(null===n||void 0===n?void 0:n.valueStyle)||{},l=(null===n||void 0===n?void 0:n.valueClassName)||"",d=null===n||void 0===n?void 0:n.render,s=(null===a||void 0===a?void 0:a[e])||{},b=(null===s||void 0===s?void 0:s[t])||"";return d&&(b=d(b,s,e)),Object(c.b)(r,{index:e,colSpan:i,className:o,children:Object(c.b)("div",{style:u,className:l,children:b})},t)}))})}},718:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var a=t(30),c=t(10),i=t(678),o={khachHangName:{id:"khachHangName",name:"T\xean KH",className:"text-small font-weight-bold",width:100,align:"",isSearch:!0,form:{required:!0,type:"input"}},tenDayDu:{id:"tenDayDu",name:"T\xean \u0111\u1ea7y \u0111\u1ee7",className:"text-small",width:110,align:"",isSearch:!0,sorter:Object(c.sortByText)("tenDayDu"),form:{type:"input"}},nhomKhachHang:{id:"nhomKhachHang",name:"Nh\xf3m kh\xe1ch h\xe0ng",className:"text-small",width:110,align:"",isSearch:!0,sorter:Object(c.sortByText)("nhomKhachHang"),form:{type:"input"}},getTableColumns:function(){return[a.a.stt,this.khachHangName,this.nhomKhachHang,i.a.tenNhomMatHang,a.a.active,a.a.editRow]},getInputFields:function(n){return[this.khachHangName]}}},735:function(n,e,t){"use strict";var a=t(12),c=t(14),i=t(0),o=t.n(i),r=t(687),u=t(10),l=t(54),d=t(30),s=t(685),b=t(678),h=t(689),f=t(226),O=t(15),m=d.d.donHangMuaModal,g=Object(i.memo)((function(n){var e=n.pageData,t=Object(l.c)((function(n){return n.hideColumns})),i=null===t||void 0===t?void 0:t[m||""],g=o.a.useMemo((function(){var n=[d.a.stt,s.b.tenMatHang,b.a.tenNhomMatHang,h.b.soLuong,h.b.soLuongThuc,f.a.tenDonViTinh,h.b.gia],e=[h.b.thanhTien];return[{id:0,colSpan:0+n.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:e.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(n){return Object(u.formatNumber)(n)}},{id:2,colSpan:[].reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),j=o.a.useMemo((function(){return e.reduce((function(n,e){var t=n.thanhTien+(e.thanhTien||0);return Object(c.a)(Object(c.a)({},n),{},{thanhTien:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTien:0})}),[e]),p=o.a.useMemo((function(){return["tong","thanhTien"].map((function(n,e){return Object(a.a)({},e,j[n])}))}),[j]);return Object(O.b)(r.a,{columns:g,dataSource:p})}));e.a=g},736:function(n,e,t){"use strict";var a=t(5),c=t.n(a),i=t(8),o=t(0),r=t.n(o),u=t(10),l=t(57),d=t(45),s=t(269),b=t(54),h=t(223),f=t(718),O=t(672),m=t(365),g=t(30),j=t(345),p=t(71),v=t(679),H=t(701),y=t(337),k=t(15),S=g.d.khachHangModal;e.a=function(n){var e,t,a=n.onAfterAddFinish,o=Object(O.a)({Instance:m.a,onPending:j.d,addSelectedId:j.a}),g=Object(b.b)(),N=Object(d.u)(),w=Object(b.c)((function(n){return n.form})),T=w.modal,C=w.datas,x=Object(b.c)((function(n){return n.account})).accountData,I=null===x||void 0===x||null===(e=x.paths)||void 0===e||null===(t=e.khachHang)||void 0===t?void 0:t.edit,M=r.a.useMemo((function(){var n;return!!(null===T||void 0===T||null===(n=T[S])||void 0===n?void 0:n.open)}),[T[S]]);function D(){return(D=Object(i.a)(c.a.mark((function n(e,t){var i,r,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(I){n.next=2;break}return n.abrupt("return",Object(p.f)());case 2:return i=!0,n.next=5,g(Object(y.d)(t));case 5:if(r=n.sent,!t){n.next=20;break}if(null===e||void 0===e?void 0:e.id){n.next=15;break}return n.next=10,g(o.onAddAsync({validatedValues:r}));case 10:i=n.sent,null===a||void 0===a||a(null===(u=i)||void 0===u?void 0:u.id),i=Boolean(i),n.next=20;break;case 15:return n.t0=Boolean,n.next=18,g(o.onUpdateAsync({currentData:e,validatedValues:r}));case 18:n.t1=n.sent,i=(0,n.t0)(n.t1);case 20:i&&g(h.a({modalId:S}));case 21:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(k.b)(u.MyModal,{form:!0,title:Object(k.c)("div",{children:["Kh\xe1ch H\xe0ng ",Object(k.b)(l.a,{icon:Object(k.b)(s.a,{}),onClick:function(){N(v.a.matHang)},children:"Trang qu\u1ea3n l\xfd"})]}),visible:M,onClose:function(){g(h.a({modalId:S}))},onOkModal:function(n,e){return D.apply(this,arguments)},formOptions:Object(u.getFormItemFields)(f.a.getInputFields()),formProps:{labelCol:{span:8},wrapperCol:{span:16}},width:700,modalId:S,datas:C,children:Object(k.b)(H.a,{mode:"multiple",isAddNew:!0,isTrangQuanLy:!0})})}},941:function(n,e,t){"use strict";t.r(e);var a=t(41),c=t(0),i=t.n(c),o=t(308),r=t(45),u=t(54),l=t(674),d=t(30),s=t(675),b=t(374),h=t(673),f=t(733),O=t(218),m=t(672),g=t(88),j=t(373),p=t(335),v=t(338),H=t(100),y=t(5),k=t.n(y),S=t(12),N=t(14),w=t(8),T=t(39),C=t.n(T),x=t(57),I=t(187),M=t(459),D=t(173),F=t(10),B=t(71),L=t(356),A=t(223),K=t(109),E=t(345),P=t(736),V=t(81),X=t(269),J=t(679),G=t(15),Q=function(n){var e,t,a=n.form,c=n.name,o=n.mode,l=n.label,s=n.labelCol,b=n.wrapperCol,h=n.rules,f=n.isAddNew,O=n.isTrangQuanLy,m=n.onAfterSelect,g=n.disabled,j=Object(u.b)(),p=Object(r.u)(),v=Object(u.c)((function(n){return n.khachHang})).khachHangs,H=Object(u.c)((function(n){return n.account})).accountData,y=i.a.useMemo((function(){return Object.values(v).filter((function(n){return n.active})).map((function(n){var e="".concat(n.khachHangName);return{value:n.id,label:e}}))}),[v]),k=null===H||void 0===H||null===(e=H.paths)||void 0===e||null===(t=e.khachHang)||void 0===t?void 0:t.edit;var S=Object(G.b)(F.MyFormItem,{label:l||"Kh\xe1ch h\xe0ng",type:"select",name:c||"khachHangId",innerProps:{mode:o,showSearch:!0,allowClear:!0,filterOption:F.onSelectSearch,onChange:function(n){j(Object(E.a)(n)),null===m||void 0===m||m(n)},disabled:g,notFoundContent:k?Object(G.c)("div",{children:[f?Object(G.b)(x.a,{icon:Object(G.b)(V.a,{}),type:"primary",onClick:function(){return j(Object(A.c)({modalId:d.d.khachHangModal}))}}):null,O?Object(G.b)(x.a,{icon:Object(G.b)(X.a,{}),type:"dashed",onClick:function(){p(J.a.khachHang)},children:"Q. l\xfd"}):null]}):Object(G.b)(K.a,{})},options:y,rules:h||[]});return a?Object(G.c)(G.a,{children:[Object(G.b)(F.MyForm,{form:a,labelCol:s||{span:8},wrapperCol:b||{span:16},children:S}),k&&Object(G.b)(P.a,{onAfterAddFinish:function(n){a.setFieldsValue({khachHangId:n})}})]}):Object(G.c)(G.a,{children:[S,k&&Object(G.b)(P.a,{})]})},R=function(n){var e=n.form,t=(n.isEdit,Object(u.b)()),a=Object(u.c)((function(n){return n.donHang})),c=a.isRutGon,o=a.isNhapSLThuc,r=Object(u.c)((function(n){return n.matHang})).matHangs,s=Object(u.c)((function(n){return n.chiTietDonHang})).chiTietDonHangs,h=Object(u.c)((function(n){return n.khachHang})).khachHangId,f=Object(u.c)((function(n){return n.form})).datas[d.d.donHangBanModal];function O(){return O=Object(w.a)(k.a.mark((function n(){var a,c,i;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.validateFields();case 2:if(a=n.sent,window.confirm("X\xe1c nh\u1eadn t\u1ea1o \u0111\u01a1n?")){n.next=5;break}return n.abrupt("return");case 5:return c=Object.values(s).filter((function(n){return n.soLuong})).reduce((function(n,e){return Object(N.a)(Object(N.a)({},n),{},Object(S.a)({},e.id,e))}),{}),a=Object(F.convertMomentToString)(b.a.getInputFields(),a),n.next=9,t(Object(D.c)(a));case 9:return a=n.sent,i=Object(N.a)(Object(N.a)({},a),{},{chiTietDonHangs:c}),n.next=13,t(Object(j.c)(i));case 13:return n.next=15,p();case 15:case"end":return n.stop()}}),n)}))),O.apply(this,arguments)}function m(){return(m=Object(w.a)(k.a.mark((function n(){var a,c,i,o,r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.validateFields();case 2:if(a=n.sent,c=a.ngayNhan,i=C()(c).format("L"),window.confirm("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt?")){n.next=7;break}return n.abrupt("return");case 7:return o=Object.values(s).filter((function(n){return n.soLuong||n.soLuongThuc})).reduce((function(n,e){return Object(N.a)(Object(N.a)({},n),{},Object(S.a)({},e.id,e))}),{}),r=Object(N.a)(Object(N.a)({},f),{},{chiTietDonHangs:o,ngayNhan:i}),n.next=11,t(Object(j.e)(r));case 11:localStorage.setItem("chiTietDonHangs",JSON.stringify({})),e.resetFields(),t(Object(A.a)({modalId:d.d.donHangBanModal})),t(Object(g.f)(!1)),t(Object(L.e)(f.nhaCungCapId));case 16:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function p(){return v.apply(this,arguments)}function v(){return(v=Object(w.a)(k.a.mark((function n(){return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:localStorage.setItem("chiTietDonHangs",JSON.stringify({})),t(Object(A.a)({modalId:d.d.donHangBanModal})),t(Object(L.e)(h)),t(Object(g.f)(!1)),e.resetFields(),Object(B.e)();case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return i.a.useEffect((function(){if(f)e.setFieldsValue(f),t(Object(L.b)(f)),localStorage.setItem("chiTietDonHangs",JSON.stringify((null===f||void 0===f?void 0:f.chiTietDonHangs)||{}));else{var n=localStorage.getItem("khachHangId")||"";t(Object(D.a)(n)),n&&r&&t(Object(L.d)(n)),e.setFieldsValue({khachHangId:n})}}),[r,c,f]),i.a.useEffect((function(){f&&t(Object(g.f)(!0))}),[f]),Object(G.b)(G.a,{children:Object(G.b)(l.a,{header:Object(G.b)("div",{className:"font-weight-bold mt-1",children:Object(G.b)("div",{children:"Th\xf4ng Tin \u0110\u01a1n H\xe0ng Mua"})}),body:Object(G.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(G.b)(F.MyForm,{labelCol:{span:8},wrapperCol:{span:16},form:e,options:Object(F.getFormItemFields)(b.a.getInputFields()),children:Object(G.b)(Q,{isAddNew:!0,isTrangQuanLy:!0,onAfterSelect:function(n){localStorage.setItem("khachHangId",n),t(Object(L.e)(n))},rules:[{required:!0,message:"Ch\u01b0a nh\u1eadp"}],disabled:!!f})}),f?Object(G.b)("div",{children:Object(G.b)(x.a,{type:o?"primary":"dashed",onClick:function(){t(Object(g.e)(!o))},children:"M\u1edf nh\u1eadp s\u1ed1 l\u01b0\u1ee3ng nh\u1eadn"})}):null]}),footer:f?Object(G.c)("div",{children:[Object(G.b)(x.a,{danger:!0,type:"dashed",icon:Object(G.b)(I.a,{}),onClick:function(){window.confirm("X\xe1c nh\u1eadn x\xf3a d\u1eef li\u1ec7u \u0111\xe3 nh\u1eadp?")&&p()},children:"X\xf3a SL"}),Object(G.b)(x.a,{type:"primary",icon:Object(G.b)(M.a,{}),onClick:function(){return m.apply(this,arguments)},children:"C\u1eadp nh\u1eadt phi\u1ebfu"})]}):Object(G.c)("div",{children:[Object(G.b)(x.a,{danger:!0,type:"dashed",icon:Object(G.b)(I.a,{}),onClick:p,children:"X\xf3a SL"}),Object(G.b)(x.a,{type:"primary",icon:Object(G.b)(M.a,{}),onClick:function(){return O.apply(this,arguments)},children:"T\u1ea1o phi\u1ebfu"})]})})})},q=t(689),z=t(735),U=d.d.donHangBanModal;e.default=function(){var n,e,t=Object(u.b)(),c=Object(r.u)(),i=Object(u.c)((function(n){var e;return null===(e=n.tagsPage)||void 0===e?void 0:e[U]})),y=Object(u.c)((function(n){return n.donHang})),k=y.isRutGon,S=y.isNhapSLThuc,N=Object(u.c)((function(n){return n.donHangBan})),w=N.tabsData,T=N.loading,C=N.pageSize,x=Object(u.c)((function(n){return n.chiTietDonHang})).chiTietDonHangs,I=Object(u.c)((function(n){return n.form})).datas[d.d.donHangBanModal],M=Object(m.a)({Instance:O.a,onPending:j.d,addSelectedId:j.a}),D=Object(u.c)((function(n){return n.account})).accountData,F=null===D||void 0===D||null===(n=D.paths)||void 0===n||null===(e=n.donHangBan)||void 0===e?void 0:e.edit,K=Object(o.useForm)(),E=Object(a.a)(K,1)[0];return Object(G.c)("div",{className:"donHangBan-page",css:s.a,children:[Object(G.b)(l.b,{className:"tabs",options:w,activeKey:k?"rutGon":i?"aside":"",onTabClick:function(n){if("add"===n){if(!F)return Object(B.f)();if(!window.confirm("X\xe1c nh\u1eadn th\xeam m\u1eb7t h\xe0ng?"))return;c(J.a.matHang)}else"rutGon"===n?t(Object(g.f)(!k)):"aside"===n?t(Object(v.b)({tagPageId:U})):"taiExcel"===n?t(Object(p.b)({tableId:U,constants:b.a,fileSheet:"donHangBanSheet",fileName:"donHangBanName"})):"themMatHang"===n&&t(Object(A.c)({modalId:d.d.matHangModal}))}}),Object(G.c)("div",{className:"tabs-main",children:[i&&Object(G.b)(R,{form:E,isEdit:F}),Object(G.b)("div",{className:"aside-main form-input-table",children:Object(G.b)(h.a,{pagination:!0,isEdit:F,inputOptions:{isNhapSLThuc:S},onCallbackDataSource:function(n){return Object(H.orderBy)(n,["tenNhomMatHang","tenMatHang"])},constants:I?q.c:q.a,actions:M,datas:x,loading:T,modalId:U,form:E,pageSize:C,onChange:function(n){return t(Object(j.f)(n.pageSize))},onBlur:function(n){return t(Object(L.f)({name:n.target.name,value:n.target.value}))},summary:function(n){return I?Object(G.b)(z.a,{pageData:n}):null}})})]}),Object(G.b)(f.a,{})]})}}}]);