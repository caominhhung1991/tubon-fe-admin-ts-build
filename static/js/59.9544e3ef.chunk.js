(this["webpackJsonptu-bon"]=this["webpackJsonptu-bon"]||[]).push([[59],{1010:function(n,e,t){"use strict";t.r(e);var a=t(13),o=t(8),i=t(0),c=t.n(i),u=t(56),r=t(7),d=t(714),l=t(64),b=t(718),h=t(96),s=t(104),O=t(751),j=t(103),p={getTableColumns:function(){return[r.constants.stt,h.a.tenMatHang,s.a.tenNhomMatHang,O.a.soLuongTonKho,j.a.tenDonViTinh,O.a.giaNhapTonKho,O.a.thanhTienTonKho]},getInputFields:function(){return[]},getExcelFields:function(){return this.getTableColumns()}},g=t(717),f=t(462),v=t(713),m=t(392),M=t(59),T=t(357),C=t(494),L=t(65),N=t(32),k=t.n(N),K=t(807),S=t(336),x=t(14),I=t(349),H=t(5),y=t.n(H),w=t(10),E=t(40),D=t(55),F=t(505),G=t(476),A=t(223),P=t(413),X=t(778),R=t(105),z=t(720),V=t(762),q=t(25),B=l.c.phieuKhoXuatModal;var J=function(n){var e=n.pageData,t=Object(u.c)((function(n){return n.hideColumns})),i=null===t||void 0===t?void 0:t[B||""],d=c.a.useMemo((function(){var n=[r.constants.stt,h.a.tenMatHang,V.a.soLuongNhapKho,j.a.tenDonViTinh,h.a.giaNhapMatHang],e=[V.a.thanhTienGiaNhap],t=[r.constants.editRow];return[{id:0,colSpan:1+n.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:e.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(n){return Object(r.formatNumber)(n)}},{id:2,colSpan:t.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),l=c.a.useMemo((function(){return e.reduce((function(n,e){var t=n.thanhTienGiaNhap+(e.thanhTienGiaNhap||0);return Object(o.a)(Object(o.a)({},n),{},{thanhTienGiaNhap:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienGiaNhap:0})}),[e]),b=c.a.useMemo((function(){return["tong","thanhTienGiaNhap"].map((function(n,e){return Object(a.a)({},e,l[n])}))}),[l]);return Object(q.b)(z.a,{columns:d,dataSource:b})},Q=l.c.phieuKhoXuatModal;var U=function(n){var e,t,i=n.isEdit,d=n.modalId,b=Object(u.b)(),h=Object(u.c)((function(n){return n.phieuKhoXuat})),s=h.loading,O=h.pageSize,j=Object(u.c)((function(n){return n.phieuKho})).phieuKhoChiTiets,p=Object(u.c)((function(n){return n.dsMatHang})).dsMatHangs,f=Object(u.c)((function(n){return n.account})).accountData;i=i||(null===f||void 0===f||null===(e=f.paths)||void 0===e||null===(t=e.phieuKhoXuat)||void 0===t?void 0:t.edit),d=d||Q;var m=Object(v.a)({Instance:I.a,onPending:P.c,addSelectedId:P.a,isEdit:i,onDelete:X.a}),M=c.a.useMemo((function(){return j?Object.values(j).reduce((function(n,e){var t=e.matHangId,i=e.giaNhapMatHang,c=void 0===i?0:i,u=e.soLuongNhapKho,r=void 0===u?0:u,d=(null===p||void 0===p?void 0:p[t])||{},l=Math.round(c*r);return Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},t,Object(o.a)(Object(o.a)(Object(o.a)({},d),e),{},{thanhTienGiaNhap:l})))}),{}):{}}),[j,p]);return Object(q.c)("div",{children:[Object(q.b)(g.a,{isEdit:i,constants:V.a,actions:m,datas:M,loading:s,modalId:d,expandable:{expandedRowRender:function(n){return Object(q.b)("div",{children:n.id})},expandRowByClick:!1},isSelection:!1,pagination:!1,pageSize:O,onChange:function(n){b(Object(P.f)(n.pageSize))},inputOptions:{openEditSoLuongNhapKho:function(n){b(Object(r.openModal)({modalId:l.c.openEditSoLuong,data:n}))},openEditGiaNhapMatHang:function(n){b(Object(r.openModal)({modalId:l.c.openEditGiaMatHang,data:n}))}},summary:function(n){return Object(q.b)(J,{pageData:n})}}),Object(q.b)(r.SoLuongInputModal,{soLuongName:"soLuongNhapKho",soLuongLabel:"S\u1ed1 l\u01b0\u1ee3ng nh\u1eadp",onOk:function(n){b(Object(X.d)(n)),b(Object(R.d)(!0))}}),Object(q.b)(r.GiaMatHangInputModal,{giaMatHangName:"giaNhapMatHang",giaMatHangLabel:"Gi\xe1 nh\u1eadp",onOk:function(n){b(Object(X.b)(n)),b(Object(R.d)(!0))}})]})},W=t(752),Y=t(851),Z=t(852),$=t(156),_=t(35),nn=t(779),en=t(165);var tn=function(n){var e=n.form,t=n.name,a=n.mode,o=n.label,i=n.labelCol,u=n.wrapperCol,d=n.rules,l=n.onAfterSelect,b=n.disabled,h=c.a.useMemo((function(){return Object.values(en.d).filter((function(n){return n.active})).map((function(n){var e="".concat(n.tenLoaiPhieuKho);return{value:n.id,label:e}}))}),[en.d]),s=Object(q.b)(r.MyFormItem,{label:o||"Lo\u1ea1i phi\u1ebfu xu\u1ea5t",type:"select",name:t||"loaiPhieuKhoId",innerProps:{mode:a,showSearch:!0,allowClear:!0,filterOption:r.onSelectSearch,onChange:function(n){null===l||void 0===l||l(n)},disabled:b},options:h,rules:d||[]});return e?Object(q.b)(q.a,{children:Object(q.b)(r.MyForm,{form:e,labelCol:i||{span:8},wrapperCol:u||{span:16},children:s})}):s},an=t(430),on=l.c.phieuKhoXuatModal;var cn=function(n){var e,t,a=n.isEdit,i=n.onStopListen,d=n.onListen,b=n.khoId,h=G.a.useForm(),s=Object(E.a)(h,1)[0],O=Object(u.b)(),j=Object(u.c)((function(n){return n.form})),p=j.modal,g=j.datas,f=Object(u.c)((function(n){return n.account})).accountData,v=Object(u.c)((function(n){return n.phieuKho})),m=v.phieuKhoLoading,T=v.phieuKhoDirty,C=v.phieuKhoChiTiets,L=Object(u.c)((function(n){return n.matHangTonKho})).matHangTonKhos,N=null===g||void 0===g?void 0:g[on];a=a||(null===f||void 0===f||null===(e=f.paths)||void 0===e||null===(t=e.phieuNhapKho)||void 0===t?void 0:t.edit);var k=c.a.useMemo((function(){var n;return!!(null===p||void 0===p||null===(n=p[on])||void 0===n?void 0:n.open)}),[p[on]]);function K(){return(K=Object(w.a)(y.a.mark((function n(){var e;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Object(Y.b)("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt phi\u1ebfu nh\u1eadp?")){n.next=2;break}return n.abrupt("return");case 2:return null===i||void 0===i||i(),n.next=5,s.validateFields();case 5:if(e=n.sent,e=O(Object($.a)(e)),null===N||void 0===N?void 0:N.id){n.next=12;break}return n.next=10,O(Object(P.d)(Object(o.a)(Object(o.a)({},N),e)));case 10:n.next=14;break;case 12:return n.next=14,O(Object(P.e)(Object(o.a)(Object(o.a)({},N),e)));case 14:O(Object(r.closeModal)({modalId:on})),O(Object(R.d)(!1)),s.resetFields(),null===d||void 0===d||d();case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return c.a.useEffect((function(){var n=N;n&&(n=Object(r.convertToMoment)([nn.a.ngay],N)),O(Object(R.c)(null===N||void 0===N?void 0:N.phieuKhoChiTiets)),s.setFieldsValue(n)}),[N]),c.a.useEffect((function(){k?O(Object(an.b)(b)):Object(x.i)("matHangTonKho")}),[k,b]),Object(q.c)(r.MyModal,{title:Object(q.b)("div",{children:"Phi\u1ebfu Xu\u1ea5t Kho"}),visible:k,onClose:function(){if(T&&!Object(Y.a)())return null;O(Object(r.closeModal)({modalId:on})),O(Object(R.d)(!1)),O(Object(R.c)({})),s.resetFields()},width:900,modalId:on,datas:g,footer:null,children:[Object(q.c)(r.MyForm,{form:s,children:[Object(q.b)(r.MyFormItem,{name:"ngay",label:"Ng\xe0y: ",rules:[{required:!0}],children:Object(q.b)(A.a,{})}),Object(q.b)(Z.a,{rules:[{required:!0}]}),Object(q.b)(tn,{rules:[{required:!0}]}),Object(q.b)(r.MyFormItem,{label:"Ch\u1ee9c n\u0103ng: ",children:Object(q.b)(M.a,{type:"primary",icon:Object(q.b)(D.a,{}),onClick:function(){O(Object(r.openModal)({modalId:l.c.openAddMatHangSoLuongModal}))},children:"Th\xeam m\u1eb7t h\xe0ng"})})]}),Object(q.b)(U,{isEdit:a,modalId:l.c.openAddMatHangSoLuongModal}),Object(q.b)(W.a,{soLuongName:"soLuongXuatKho",soLuongLabel:"S\u1ed1 l\u01b0\u1ee3ng xu\u1ea5t",giaMatHangName:"giaBanMatHang",giaMatHangLabel:"Gi\xe1 b\xe1n",onAfterAddFinish:function(n){O(Object(X.c)(n)),O(Object(R.d)(!0)),Object(_.g)("\u0110\xe3 l\u01b0u v\xe0o phi\u1ebfu nh\u1eadp kho!")},matHangFilters:{chaLua:!0},notAutoCloseAfterOk:!0,loaiTruMatHangs:C,defaultValues:L}),Object(q.b)("div",{className:"mt-1",style:{textAlign:"right"},children:Object(q.b)(M.a,{loading:m,type:"primary",icon:Object(q.b)(F.a,{}),onClick:function(){return K.apply(this,arguments)},children:"L\u01b0u phi\u1ebfu xu\u1ea5t kho"})})]})},un="khoChaLua";var rn=function(n){var e,t,a=Object(u.b)(),i=Object(u.c)((function(n){return n.account})).accountData,c=null===i||void 0===i||null===(e=i.paths)||void 0===e||null===(t=e.khoChaLua)||void 0===t?void 0:t.edit;return Object(q.c)(q.a,{children:[Object(q.b)(d.a,{header:Object(q.b)("div",{className:"font-weight-bold",children:Object(q.b)("span",{children:"Th\xf4ng Tin Trang "})}),body:Object(q.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(q.b)("div",{className:"mt-1",children:Object(q.b)(M.a,{icon:Object(q.b)(T.a,{}),onClick:function(){var n=(new S.a).initData,e=k()();a(Object(r.openModal)({modalId:l.c.phieuKhoNhapModal,data:Object(o.a)(Object(o.a)({},n),{},{ngay:e,khoId:un})}))},block:!0,children:"Th\xeam phi\u1ebfu nh\u1eadp kho"})}),Object(q.b)("div",{className:"mt-1",children:Object(q.c)(M.a,{block:!0,onClick:function(){var n=(new I.a).initData,e=k()();a(Object(r.openModal)({modalId:l.c.phieuKhoXuatModal,data:Object(o.a)(Object(o.a)({},n),{},{ngay:e,khoId:un})}))},children:["Th\xeam phi\u1ebfu xu\u1ea5t kho ",Object(q.b)(C.a,{})]})})]}),footer:Object(q.b)("div",{children:Object(q.b)(M.a,{icon:Object(q.b)(L.a,{}),onClick:function(){a(Object(r.toggleAside)({tagPageId:l.c.khoChaLuaModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})}),Object(q.b)(K.a,{isEdit:c,onStopListen:function(){return Object(x.i)("khoChaLua")},onListen:function(){return a(Object(m.c)())}}),Object(q.b)(cn,{khoId:un,isEdit:c,onStopListen:function(){return Object(x.i)("khoChaLua")},onListen:function(){return a(Object(m.c)())}})]})},dn=t(365),ln=l.c.khoChaLuaModal;var bn=function(n){var e=n.pageData,t=Object(u.c)((function(n){return n.hideColumns})),i=null===t||void 0===t?void 0:t[ln||""],d=c.a.useMemo((function(){var n=[r.constants.stt,h.a.tenMatHang,s.a.tenNhomMatHang,O.a.soLuongTonKho,j.a.tenDonViTinh,O.a.giaNhapTonKho],e=[O.a.thanhTienTonKho];return[{id:0,colSpan:2+n.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:e.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(n){return Object(r.formatNumber)(n)}},{id:2,colSpan:[].reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),l=c.a.useMemo((function(){return e.reduce((function(n,e){var t=n.thanhTienTonKho+(e.thanhTienTonKho||0);return Object(o.a)(Object(o.a)({},n),{},{thanhTienTonKho:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienTonKho:0})}),[e]),b=c.a.useMemo((function(){return["tong","thanhTienTonKho"].map((function(n,e){return Object(a.a)({},e,l[n])}))}),[l]);return Object(q.b)(z.a,{columns:d,dataSource:b})},hn=l.c.khoChaLuaModal;e.default=function(){var n,e,t=Object(u.b)(),i=Object(u.c)((function(n){return n.khoChaLua})),l=i.tabsData,h=i.loading,s=i.pageSize,O=i.khoChaLuas,j=Object(u.c)((function(n){return n.dsMatHang})).dsMatHangs,M=Object(u.c)((function(n){var e;return null===(e=n.tagsPage)||void 0===e?void 0:e[hn]})),T=Object(u.c)((function(n){return n.account})).accountData,C=null===T||void 0===T||null===(n=T.paths)||void 0===n||null===(e=n.khoChaLua)||void 0===e?void 0:e.edit,L=Object(v.a)({Instance:f.a,onPending:m.d,addSelectedId:m.a,isEdit:C});c.a.useEffect((function(){return t(Object(m.c)()),function(){Object(x.i)("khoChaLua")}}),[]);var N=c.a.useMemo((function(){return Object.values(O).map((function(n){var e=n.soLuongTonKho,t=void 0===e?0:e,a=n.giaNhapTonKho,i=void 0===a?0:a,c=(null===j||void 0===j?void 0:j[null===n||void 0===n?void 0:n.id])||{},u=Math.round(t*i);return Object(o.a)(Object(o.a)(Object(o.a)({},c),n),{},{thanhTienTonKho:u})})).reduce((function(n,e){return Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},e.id,e))}),{})}),[j,O]);return Object(q.c)("div",{className:"khoChaLua-page",css:b.a,children:[Object(q.b)(d.b,{className:"tabs",options:l,activeKey:M?"aside":"",onTabClick:function(n){if("add"===n&&C){if(!C)return Object(_.j)();var e=new f.a;t(Object(r.openModal)({modalId:hn,data:e.initData}))}else"aside"===n?t(Object(r.toggleAside)({tagPageId:hn})):"taiExcel"===n&&t(Object(r.downloadExcel)({tableId:hn,constants:p,fileSheet:"khoChaLuaSheet",fileName:"khoChaLuaName"}))}}),Object(q.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[M&&Object(q.b)(rn,{}),Object(q.b)("div",{className:"aside-main",children:Object(q.b)(g.a,{isEdit:C,onCallbackDataSource:function(n){return Object(dn.a)("tenMatHang",n)},constants:p,actions:L,datas:N,loading:h,modalId:hn,expandable:{expandedRowRender:function(n){return Object(q.b)("div",{children:n.id})},expandRowByClick:!1},isSelection:!0,pagination:!0,pageSize:s,onChange:function(n){t(Object(m.e)(n.pageSize))},onRow:function(n){return{onClick:function(){C&&t(Object(r.openModal)({modalId:hn,data:n}))}}},summary:function(n){return Object(q.b)(bn,{pageData:n})}})})]})]})}}}]);