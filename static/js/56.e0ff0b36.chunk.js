(this["webpackJsonptu-bon"]=this["webpackJsonptu-bon"]||[]).push([[56],{1019:function(e,n,t){"use strict";t.r(n);var a=t(13),o=t(10),i=t(0),c=t.n(i),u=t(57),d=t(366),r=t(365),l=t(236),b=t(724),h=t(30),s=t(727),O=t(142),j=t(332),p=t(774),f=t(163),v={getTableColumns:function(){return[h.a.stt,O.a.tenMatHang,j.a.tenNhomMatHang,p.a.soLuongTonKho,f.a.tenDonViTinh,p.a.giaNhapTonKho,p.a.thanhTienTonKho]},getInputFields:function(){return[]},getExcelFields:function(){return this.getTableColumns()}},g=t(726),m=t(470),M=t(723),T=t(414),C=t(61),N=t(361),k=t(497),L=t(66),K=t(35),S=t.n(K),x=t(818),I=t(339),y=t(15),H=t(353),w=t(5),D=t.n(w),E=t(8),F=t(42),G=t(9),P=t(59),A=t(509),R=t(480),X=t(224),z=t(416),V=t(863),q=t(791),B=t(864),J=t(104),Q=t(732),U=t(775),W=t(17),Y=h.d.phieuKhoXuatModal;var Z=function(e){var n=e.pageData,t=Object(u.c)((function(e){return e.hideColumns})),i=null===t||void 0===t?void 0:t[Y||""],d=c.a.useMemo((function(){var e=[h.a.stt,O.a.tenMatHang,U.a.soLuongNhapKho,f.a.tenDonViTinh,O.a.giaNhapMatHang],n=[U.a.thanhTienGiaNhap],t=[h.a.editRow];return[{id:0,colSpan:1+e.reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:n.reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(G.formatNumber)(e)}},{id:2,colSpan:t.reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),r=c.a.useMemo((function(){return n.reduce((function(e,n){var t=e.thanhTienGiaNhap+(n.thanhTienGiaNhap||0);return Object(o.a)(Object(o.a)({},e),{},{thanhTienGiaNhap:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienGiaNhap:0})}),[n]),l=c.a.useMemo((function(){return["tong","thanhTienGiaNhap"].map((function(e,n){return Object(a.a)({},n,r[e])}))}),[r]);return Object(W.b)(Q.a,{columns:d,dataSource:l})},$=h.d.phieuKhoXuatModal;var _=function(e){var n,t,i=e.isEdit,d=e.modalId,r=Object(u.b)(),b=Object(u.c)((function(e){return e.phieuKhoXuat})),s=b.loading,O=b.pageSize,j=Object(u.c)((function(e){return e.phieuKho})).phieuKhoChiTiets,p=Object(u.c)((function(e){return e.dsMatHang})).dsMatHangs,f=Object(u.c)((function(e){return e.account})).accountData;i=i||(null===f||void 0===f||null===(n=f.paths)||void 0===n||null===(t=n.phieuKhoXuat)||void 0===t?void 0:t.edit),d=d||$;var v=Object(M.a)({Instance:H.a,onPending:z.c,addSelectedId:z.a,isEdit:i,onDelete:q.a}),m=c.a.useMemo((function(){return j?Object.values(j).reduce((function(e,n){var t=n.matHangId,i=n.giaNhapMatHang,c=void 0===i?0:i,u=n.soLuongNhapKho,d=void 0===u?0:u,r=(null===p||void 0===p?void 0:p[t])||{},l=Math.round(c*d);return Object(o.a)(Object(o.a)({},e),{},Object(a.a)({},t,Object(o.a)(Object(o.a)(Object(o.a)({},r),n),{},{thanhTienGiaNhap:l})))}),{}):{}}),[j,p]);return Object(W.c)("div",{children:[Object(W.b)(g.a,{isEdit:i,constants:U.a,actions:v,datas:m,loading:s,modalId:d,expandable:{expandedRowRender:function(e){return Object(W.b)("div",{children:e.id})},expandRowByClick:!1},isSelection:!1,pagination:!1,pageSize:O,onChange:function(e){r(Object(z.f)(e.pageSize))},inputOptions:{openEditSoLuongNhapKho:function(e){r(Object(l.c)({modalId:h.d.openEditSoLuong,data:e}))},openEditGiaNhapMatHang:function(e){r(Object(l.c)({modalId:h.d.openEditGiaMatHang,data:e}))}},summary:function(e){return Object(W.b)(Z,{pageData:e})}}),Object(W.b)(V.a,{soLuongName:"soLuongNhapKho",soLuongLabel:"S\u1ed1 l\u01b0\u1ee3ng nh\u1eadp",onOk:function(e){r(Object(q.d)(e)),r(Object(J.d)(!0))}}),Object(W.b)(B.a,{giaMatHangName:"giaNhapMatHang",giaMatHangLabel:"Gi\xe1 nh\u1eadp",onOk:function(e){r(Object(q.b)(e)),r(Object(J.d)(!0))}})]})},ee=t(763),ne=t(865),te=t(866),ae=t(157),oe=t(38),ie=t(792),ce=t(168);var ue=function(e){var n=e.form,t=e.name,a=e.mode,o=e.label,i=e.labelCol,u=e.wrapperCol,d=e.rules,r=e.onAfterSelect,l=e.disabled,b=c.a.useMemo((function(){return Object.values(ce.d).filter((function(e){return e.active})).map((function(e){var n="".concat(e.tenLoaiPhieuKho);return{value:e.id,label:n}}))}),[ce.d]),h=Object(W.b)(G.MyFormItem,{label:o||"Lo\u1ea1i phi\u1ebfu xu\u1ea5t",type:"select",name:t||"loaiPhieuKhoId",innerProps:{mode:a,showSearch:!0,allowClear:!0,filterOption:G.onSelectSearch,onChange:function(e){null===r||void 0===r||r(e)},disabled:l},options:b,rules:d||[]});return n?Object(W.b)(W.a,{children:Object(W.b)(G.MyForm,{form:n,labelCol:i||{span:8},wrapperCol:u||{span:16},children:h})}):h},de=h.d.phieuKhoXuatModal;var re=function(e){var n,t,a=e.isEdit,i=e.onStopListen,d=e.onListen,r=R.a.useForm(),b=Object(F.a)(r,1)[0],s=Object(u.b)(),O=Object(u.c)((function(e){return e.form})),j=O.modal,p=O.datas,f=Object(u.c)((function(e){return e.account})).accountData,v=Object(u.c)((function(e){return e.phieuKho})),g=v.phieuKhoLoading,m=v.phieuKhoDirty,M=v.phieuKhoChiTiets,T=null===p||void 0===p?void 0:p[de];a=a||(null===f||void 0===f||null===(n=f.paths)||void 0===n||null===(t=n.phieuNhapKho)||void 0===t?void 0:t.edit);var N=c.a.useMemo((function(){var e;return!!(null===j||void 0===j||null===(e=j[de])||void 0===e?void 0:e.open)}),[j[de]]);function k(){return(k=Object(E.a)(D.a.mark((function e(){var n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(ne.b)("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt phi\u1ebfu nh\u1eadp?")){e.next=2;break}return e.abrupt("return");case 2:return null===i||void 0===i||i(),e.next=5,b.validateFields();case 5:if(n=e.sent,n=s(Object(ae.a)(n)),null===T||void 0===T?void 0:T.id){e.next=12;break}return e.next=10,s(Object(z.d)(Object(o.a)(Object(o.a)({},T),n)));case 10:e.next=14;break;case 12:return e.next=14,s(Object(z.e)(Object(o.a)(Object(o.a)({},T),n)));case 14:s(l.a({modalId:de})),s(Object(J.d)(!1)),b.resetFields(),null===d||void 0===d||d();case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return c.a.useEffect((function(){var e=T;e&&(e=Object(G.convertToMoment)([ie.a.ngay],T)),s(Object(J.c)(null===T||void 0===T?void 0:T.phieuKhoChiTiets)),b.setFieldsValue(e)}),[T]),Object(W.c)(G.MyModal,{title:Object(W.b)("div",{children:"Phi\u1ebfu Xu\u1ea5t Kho"}),visible:N,onClose:function(){if(m&&!Object(ne.a)())return null;s(l.a({modalId:de})),s(Object(J.d)(!1)),s(Object(J.c)({})),b.resetFields()},width:900,modalId:de,datas:p,footer:null,children:[Object(W.c)(G.MyForm,{form:b,children:[Object(W.b)(G.MyFormItem,{name:"ngay",label:"Ng\xe0y: ",rules:[{required:!0}],children:Object(W.b)(X.a,{})}),Object(W.b)(te.a,{rules:[{required:!0}]}),Object(W.b)(ue,{rules:[{required:!0}]}),Object(W.b)(G.MyFormItem,{label:"Ch\u1ee9c n\u0103ng: ",children:Object(W.b)(C.a,{type:"primary",icon:Object(W.b)(P.a,{}),onClick:function(){s(Object(l.c)({modalId:h.d.matHangAddSoLuongModal}))},children:"Th\xeam m\u1eb7t h\xe0ng"})})]}),Object(W.b)(_,{isEdit:a,modalId:h.d.matHangAddSoLuongModal}),Object(W.b)(ee.a,{soLuongName:"soLuongNhapKho",giaMatHangName:"giaNhapMatHang",onAfterAddFinish:function(e){s(Object(q.c)(e)),s(Object(J.d)(!0)),Object(oe.c)("\u0110\xe3 l\u01b0u v\xe0o phi\u1ebfu nh\u1eadp kho!")},matHangFilters:{chaLua:!0},notAutoCloseAfterOk:!0,loaiTruMatHangs:M}),Object(W.b)("div",{className:"mt-1",style:{textAlign:"right"},children:Object(W.b)(C.a,{loading:g,type:"primary",icon:Object(W.b)(A.a,{}),onClick:function(){return k.apply(this,arguments)},children:"L\u01b0u phi\u1ebfu xu\u1ea5t kho"})})]})};var le=function(e){var n,t,a=Object(u.b)(),i=Object(u.c)((function(e){return e.account})).accountData,c=null===i||void 0===i||null===(n=i.paths)||void 0===n||null===(t=n.khoChaLua)||void 0===t?void 0:t.edit;return Object(W.c)(W.a,{children:[Object(W.b)(b.a,{header:Object(W.b)("div",{className:"font-weight-bold",children:Object(W.b)("span",{children:"Th\xf4ng Tin Trang "})}),body:Object(W.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(W.b)("div",{className:"mt-1",children:Object(W.b)(C.a,{icon:Object(W.b)(N.a,{}),onClick:function(){var e=(new I.a).initData,n=S()();a(Object(l.c)({modalId:h.d.phieuKhoNhapModal,data:Object(o.a)(Object(o.a)({},e),{},{ngay:n,khoId:"khoChaLua"})}))},block:!0,children:"Th\xeam phi\u1ebfu nh\u1eadp kho"})}),Object(W.b)("div",{className:"mt-1",children:Object(W.c)(C.a,{block:!0,onClick:function(){var e=(new H.a).initData,n=S()();a(Object(l.c)({modalId:h.d.phieuKhoXuatModal,data:Object(o.a)(Object(o.a)({},e),{},{ngay:n,khoId:"khoChaLua"})}))},children:["Th\xeam phi\u1ebfu xu\u1ea5t kho ",Object(W.b)(k.a,{})]})})]}),footer:Object(W.b)("div",{children:Object(W.b)(C.a,{icon:Object(W.b)(L.a,{}),onClick:function(){a(Object(r.b)({tagPageId:h.d.khoChaLuaModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})}),Object(W.b)(x.a,{isEdit:c,onStopListen:function(){Object(y.i)("khoChaLua")},onListen:function(){a(Object(T.c)())}}),Object(W.b)(re,{isEdit:c,onStopListen:function(){Object(y.i)("khoChaLua")},onListen:function(){a(Object(T.c)())}})]})},be=t(375),he=h.d.khoChaLuaModal;var se=function(e){var n=e.pageData,t=Object(u.c)((function(e){return e.hideColumns})),i=null===t||void 0===t?void 0:t[he||""],d=c.a.useMemo((function(){var e=[h.a.stt,O.a.tenMatHang,j.a.tenNhomMatHang,p.a.soLuongTonKho,f.a.tenDonViTinh,p.a.giaNhapTonKho],n=[p.a.thanhTienTonKho];return[{id:0,colSpan:2+e.reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:n.reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(e){return Object(G.formatNumber)(e)}},{id:2,colSpan:[].reduce((function(e,n){var t=n.id;return e+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),r=c.a.useMemo((function(){return n.reduce((function(e,n){var t=e.thanhTienTonKho+(n.thanhTienTonKho||0);return Object(o.a)(Object(o.a)({},e),{},{thanhTienTonKho:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienTonKho:0})}),[n]),l=c.a.useMemo((function(){return["tong","thanhTienTonKho"].map((function(e,n){return Object(a.a)({},n,r[e])}))}),[r]);return Object(W.b)(Q.a,{columns:d,dataSource:l})},Oe=h.d.khoChaLuaModal;n.default=function(){var e,n,t=Object(u.b)(),i=Object(u.c)((function(e){return e.khoChaLua})),h=i.tabsData,O=i.loading,j=i.pageSize,p=i.khoChaLuas,f=Object(u.c)((function(e){return e.dsMatHang})).dsMatHangs,C=Object(u.c)((function(e){var n;return null===(n=e.tagsPage)||void 0===n?void 0:n[Oe]})),N=Object(u.c)((function(e){return e.account})).accountData,k=null===N||void 0===N||null===(e=N.paths)||void 0===e||null===(n=e.khoChaLua)||void 0===n?void 0:n.edit,L=Object(M.a)({Instance:m.a,onPending:T.d,addSelectedId:T.a,isEdit:k});c.a.useEffect((function(){return t(Object(T.c)()),function(){Object(y.i)("khoChaLua")}}),[]);var K=c.a.useMemo((function(){return Object.values(p).map((function(e){var n=e.soLuongTonKho,t=void 0===n?0:n,a=e.giaNhapTonKho,i=void 0===a?0:a,c=(null===f||void 0===f?void 0:f[null===e||void 0===e?void 0:e.id])||{},u=Math.round(t*i);return Object(o.a)(Object(o.a)(Object(o.a)({},c),e),{},{thanhTienTonKho:u})})).reduce((function(e,n){return Object(o.a)(Object(o.a)({},e),{},Object(a.a)({},n.id,n))}),{})}),[f,p]);return Object(W.c)("div",{className:"khoChaLua-page",css:s.a,children:[Object(W.b)(b.b,{className:"tabs",options:h,activeKey:C?"aside":"",onTabClick:function(e){if("add"===e&&k){if(!k)return Object(oe.f)();var n=new m.a;t(Object(l.c)({modalId:Oe,data:n.initData}))}else"aside"===e?t(Object(r.b)({tagPageId:Oe})):"taiExcel"===e&&t(Object(d.b)({tableId:Oe,constants:v,fileSheet:"khoChaLuaSheet",fileName:"khoChaLuaName"}))}}),Object(W.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[C&&Object(W.b)(le,{}),Object(W.b)("div",{className:"aside-main",children:Object(W.b)(g.a,{isEdit:k,onCallbackDataSource:function(e){return Object(be.a)("tenMatHang",e)},constants:v,actions:L,datas:K,loading:O,modalId:Oe,expandable:{expandedRowRender:function(e){return Object(W.b)("div",{children:e.id})},expandRowByClick:!1},isSelection:!0,pagination:!0,pageSize:j,onChange:function(e){t(Object(T.e)(e.pageSize))},onRow:function(e){return{onClick:function(){k&&t(Object(l.c)({modalId:Oe,data:e}))}}},summary:function(e){return Object(W.b)(se,{pageData:e})}})})]})]})}}}]);