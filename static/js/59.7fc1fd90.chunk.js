(this["webpackJsonptu-bon"]=this["webpackJsonptu-bon"]||[]).push([[59],{1021:function(n,e,t){"use strict";t.r(e);var a=t(13),o=t(7),i=t(0),c=t.n(i),u=t(57),r=t(367),d=t(365),l=t(237),b=t(722),h=t(30),s=t(725),O=t(141),j=t(162),p=t(763),g=t(163),f={getTableColumns:function(){return[h.a.stt,O.a.tenMatHang,j.a.tenNhomMatHang,p.a.soLuongTonKho,g.a.tenDonViTinh,p.a.giaNhapTonKho,p.a.thanhTienTonKho]},getInputFields:function(){return[]},getExcelFields:function(){return this.getTableColumns()}},v=t(723),m=t(470),M=t(721),T=t(399),C=t(60),L=t(362),N=t(501),k=t(65),K=t(33),S=t.n(K),x=t(819),I=t(340),y=t(15),H=t(353),w=t(5),D=t.n(w),E=t(10),F=t(41),G=t(8),P=t(56),X=t(513),A=t(484),R=t(224),z=t(419),V=t(764),q=t(790),B=t(863),J=t(103),Q=t(729),U=t(774),W=t(17),Y=h.d.phieuKhoXuatModal;var Z=function(n){var e=n.pageData,t=Object(u.c)((function(n){return n.hideColumns})),i=null===t||void 0===t?void 0:t[Y||""],r=c.a.useMemo((function(){var n=[h.a.stt,O.a.tenMatHang,U.a.soLuongNhapKho,g.a.tenDonViTinh,O.a.giaNhapMatHang],e=[U.a.thanhTienGiaNhap],t=[h.a.editRow];return[{id:0,colSpan:1+n.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:e.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(n){return Object(G.formatNumber)(n)}},{id:2,colSpan:t.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),d=c.a.useMemo((function(){return e.reduce((function(n,e){var t=n.thanhTienGiaNhap+(e.thanhTienGiaNhap||0);return Object(o.a)(Object(o.a)({},n),{},{thanhTienGiaNhap:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienGiaNhap:0})}),[e]),l=c.a.useMemo((function(){return["tong","thanhTienGiaNhap"].map((function(n,e){return Object(a.a)({},e,d[n])}))}),[d]);return Object(W.b)(Q.a,{columns:r,dataSource:l})},$=h.d.phieuKhoXuatModal;var _=function(n){var e,t,i=n.isEdit,r=n.modalId,d=Object(u.b)(),b=Object(u.c)((function(n){return n.phieuKhoXuat})),s=b.loading,O=b.pageSize,j=Object(u.c)((function(n){return n.phieuKho})).phieuKhoChiTiets,p=Object(u.c)((function(n){return n.dsMatHang})).dsMatHangs,g=Object(u.c)((function(n){return n.account})).accountData;i=i||(null===g||void 0===g||null===(e=g.paths)||void 0===e||null===(t=e.phieuKhoXuat)||void 0===t?void 0:t.edit),r=r||$;var f=Object(M.a)({Instance:H.a,onPending:z.c,addSelectedId:z.a,isEdit:i,onDelete:q.a}),m=c.a.useMemo((function(){return j?Object.values(j).reduce((function(n,e){var t=e.matHangId,i=e.giaNhapMatHang,c=void 0===i?0:i,u=e.soLuongNhapKho,r=void 0===u?0:u,d=(null===p||void 0===p?void 0:p[t])||{},l=Math.round(c*r);return Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},t,Object(o.a)(Object(o.a)(Object(o.a)({},d),e),{},{thanhTienGiaNhap:l})))}),{}):{}}),[j,p]);return Object(W.c)("div",{children:[Object(W.b)(v.a,{isEdit:i,constants:U.a,actions:f,datas:m,loading:s,modalId:r,expandable:{expandedRowRender:function(n){return Object(W.b)("div",{children:n.id})},expandRowByClick:!1},isSelection:!1,pagination:!1,pageSize:O,onChange:function(n){d(Object(z.f)(n.pageSize))},inputOptions:{openEditSoLuongNhapKho:function(n){d(Object(l.c)({modalId:h.d.openEditSoLuong,data:n}))},openEditGiaNhapMatHang:function(n){d(Object(l.c)({modalId:h.d.openEditGiaMatHang,data:n}))}},summary:function(n){return Object(W.b)(Z,{pageData:n})}}),Object(W.b)(V.a,{soLuongName:"soLuongNhapKho",soLuongLabel:"S\u1ed1 l\u01b0\u1ee3ng nh\u1eadp",onOk:function(n){d(Object(q.d)(n)),d(Object(J.d)(!0))}}),Object(W.b)(B.a,{giaMatHangName:"giaNhapMatHang",giaMatHangLabel:"Gi\xe1 nh\u1eadp",onOk:function(n){d(Object(q.b)(n)),d(Object(J.d)(!0))}})]})},nn=t(752),en=t(864),tn=t(865),an=t(156),on=t(36),cn=t(791),un=t(167);var rn=function(n){var e=n.form,t=n.name,a=n.mode,o=n.label,i=n.labelCol,u=n.wrapperCol,r=n.rules,d=n.onAfterSelect,l=n.disabled,b=c.a.useMemo((function(){return Object.values(un.d).filter((function(n){return n.active})).map((function(n){var e="".concat(n.tenLoaiPhieuKho);return{value:n.id,label:e}}))}),[un.d]),h=Object(W.b)(G.MyFormItem,{label:o||"Lo\u1ea1i phi\u1ebfu xu\u1ea5t",type:"select",name:t||"loaiPhieuKhoId",innerProps:{mode:a,showSearch:!0,allowClear:!0,filterOption:G.onSelectSearch,onChange:function(n){null===d||void 0===d||d(n)},disabled:l},options:b,rules:r||[]});return e?Object(W.b)(W.a,{children:Object(W.b)(G.MyForm,{form:e,labelCol:i||{span:8},wrapperCol:u||{span:16},children:h})}):h},dn=t(436),ln=h.d.phieuKhoXuatModal;var bn=function(n){var e,t,a=n.isEdit,i=n.onStopListen,r=n.onListen,d=n.khoId,b=A.a.useForm(),s=Object(F.a)(b,1)[0],O=Object(u.b)(),j=Object(u.c)((function(n){return n.form})),p=j.modal,g=j.datas,f=Object(u.c)((function(n){return n.account})).accountData,v=Object(u.c)((function(n){return n.phieuKho})),m=v.phieuKhoLoading,M=v.phieuKhoDirty,T=v.phieuKhoChiTiets,L=Object(u.c)((function(n){return n.matHangTonKho})).matHangTonKhos,N=null===g||void 0===g?void 0:g[ln];a=a||(null===f||void 0===f||null===(e=f.paths)||void 0===e||null===(t=e.phieuNhapKho)||void 0===t?void 0:t.edit);var k=c.a.useMemo((function(){var n;return!!(null===p||void 0===p||null===(n=p[ln])||void 0===n?void 0:n.open)}),[p[ln]]);function K(){return(K=Object(E.a)(D.a.mark((function n(){var e;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Object(en.b)("X\xe1c nh\u1eadn c\u1eadp nh\u1eadt phi\u1ebfu nh\u1eadp?")){n.next=2;break}return n.abrupt("return");case 2:return null===i||void 0===i||i(),n.next=5,s.validateFields();case 5:if(e=n.sent,e=O(Object(an.a)(e)),null===N||void 0===N?void 0:N.id){n.next=12;break}return n.next=10,O(Object(z.d)(Object(o.a)(Object(o.a)({},N),e)));case 10:n.next=14;break;case 12:return n.next=14,O(Object(z.e)(Object(o.a)(Object(o.a)({},N),e)));case 14:O(l.a({modalId:ln})),O(Object(J.d)(!1)),s.resetFields(),null===r||void 0===r||r();case 18:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return c.a.useEffect((function(){var n=N;n&&(n=Object(G.convertToMoment)([cn.a.ngay],N)),O(Object(J.c)(null===N||void 0===N?void 0:N.phieuKhoChiTiets)),s.setFieldsValue(n)}),[N]),c.a.useEffect((function(){k?O(Object(dn.b)(d)):Object(y.i)("matHangTonKho")}),[k,d]),Object(W.c)(G.MyModal,{title:Object(W.b)("div",{children:"Phi\u1ebfu Xu\u1ea5t Kho"}),visible:k,onClose:function(){if(M&&!Object(en.a)())return null;O(l.a({modalId:ln})),O(Object(J.d)(!1)),O(Object(J.c)({})),s.resetFields()},width:900,modalId:ln,datas:g,footer:null,children:[Object(W.c)(G.MyForm,{form:s,children:[Object(W.b)(G.MyFormItem,{name:"ngay",label:"Ng\xe0y: ",rules:[{required:!0}],children:Object(W.b)(R.a,{})}),Object(W.b)(tn.a,{rules:[{required:!0}]}),Object(W.b)(rn,{rules:[{required:!0}]}),Object(W.b)(G.MyFormItem,{label:"Ch\u1ee9c n\u0103ng: ",children:Object(W.b)(C.a,{type:"primary",icon:Object(W.b)(P.a,{}),onClick:function(){O(Object(l.c)({modalId:h.d.openAddMatHangSoLuongModal}))},children:"Th\xeam m\u1eb7t h\xe0ng"})})]}),Object(W.b)(_,{isEdit:a,modalId:h.d.openAddMatHangSoLuongModal}),Object(W.b)(nn.a,{soLuongName:"soLuongXuatKho",soLuongLabel:"S\u1ed1 l\u01b0\u1ee3ng xu\u1ea5t",giaMatHangName:"giaBanMatHang",giaMatHangLabel:"Gi\xe1 b\xe1n",onAfterAddFinish:function(n){O(Object(q.c)(n)),O(Object(J.d)(!0)),Object(on.g)("\u0110\xe3 l\u01b0u v\xe0o phi\u1ebfu nh\u1eadp kho!")},matHangFilters:{chaLua:!0},notAutoCloseAfterOk:!0,loaiTruMatHangs:T,defaultValues:L}),Object(W.b)("div",{className:"mt-1",style:{textAlign:"right"},children:Object(W.b)(C.a,{loading:m,type:"primary",icon:Object(W.b)(X.a,{}),onClick:function(){return K.apply(this,arguments)},children:"L\u01b0u phi\u1ebfu xu\u1ea5t kho"})})]})},hn="khoChaLua";var sn=function(n){var e,t,a=Object(u.b)(),i=Object(u.c)((function(n){return n.account})).accountData,c=null===i||void 0===i||null===(e=i.paths)||void 0===e||null===(t=e.khoChaLua)||void 0===t?void 0:t.edit;return Object(W.c)(W.a,{children:[Object(W.b)(b.a,{header:Object(W.b)("div",{className:"font-weight-bold",children:Object(W.b)("span",{children:"Th\xf4ng Tin Trang "})}),body:Object(W.c)("div",{className:"form-input-aside",style:{padding:"5px"},children:[Object(W.b)("div",{className:"mt-1",children:Object(W.b)(C.a,{icon:Object(W.b)(L.a,{}),onClick:function(){var n=(new I.a).initData,e=S()();a(Object(l.c)({modalId:h.d.phieuKhoNhapModal,data:Object(o.a)(Object(o.a)({},n),{},{ngay:e,khoId:hn})}))},block:!0,children:"Th\xeam phi\u1ebfu nh\u1eadp kho"})}),Object(W.b)("div",{className:"mt-1",children:Object(W.c)(C.a,{block:!0,onClick:function(){var n=(new H.a).initData,e=S()();a(Object(l.c)({modalId:h.d.phieuKhoXuatModal,data:Object(o.a)(Object(o.a)({},n),{},{ngay:e,khoId:hn})}))},children:["Th\xeam phi\u1ebfu xu\u1ea5t kho ",Object(W.b)(N.a,{})]})})]}),footer:Object(W.b)("div",{children:Object(W.b)(C.a,{icon:Object(W.b)(k.a,{}),onClick:function(){a(Object(d.b)({tagPageId:h.d.khoChaLuaModal}))},children:"\u0110\xf3ng m\u1edf r\u1ed9ng"})})}),Object(W.b)(x.a,{isEdit:c,onStopListen:function(){return Object(y.i)("khoChaLua")},onListen:function(){return a(Object(T.c)())}}),Object(W.b)(bn,{khoId:hn,isEdit:c,onStopListen:function(){return Object(y.i)("khoChaLua")},onListen:function(){return a(Object(T.c)())}})]})},On=t(371),jn=h.d.khoChaLuaModal;var pn=function(n){var e=n.pageData,t=Object(u.c)((function(n){return n.hideColumns})),i=null===t||void 0===t?void 0:t[jn||""],r=c.a.useMemo((function(){var n=[h.a.stt,O.a.tenMatHang,j.a.tenNhomMatHang,p.a.soLuongTonKho,g.a.tenDonViTinh,p.a.giaNhapTonKho],e=[p.a.thanhTienTonKho];return[{id:0,colSpan:2+n.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-center font-weight-bold text-danger"},{id:1,colSpan:e.reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0),cellClassName:"text-right font-weight-bold text-small text-danger",render:function(n){return Object(G.formatNumber)(n)}},{id:2,colSpan:[].reduce((function(n,e){var t=e.id;return n+((null===i||void 0===i?void 0:i[t])?0:1)}),0)}]}),[i]),d=c.a.useMemo((function(){return e.reduce((function(n,e){var t=n.thanhTienTonKho+(e.thanhTienTonKho||0);return Object(o.a)(Object(o.a)({},n),{},{thanhTienTonKho:t})}),{tong:"T\u1ed5ng ti\u1ec1n",thanhTienTonKho:0})}),[e]),l=c.a.useMemo((function(){return["tong","thanhTienTonKho"].map((function(n,e){return Object(a.a)({},e,d[n])}))}),[d]);return Object(W.b)(Q.a,{columns:r,dataSource:l})},gn=h.d.khoChaLuaModal;e.default=function(){var n,e,t=Object(u.b)(),i=Object(u.c)((function(n){return n.khoChaLua})),h=i.tabsData,O=i.loading,j=i.pageSize,p=i.khoChaLuas,g=Object(u.c)((function(n){return n.dsMatHang})).dsMatHangs,C=Object(u.c)((function(n){var e;return null===(e=n.tagsPage)||void 0===e?void 0:e[gn]})),L=Object(u.c)((function(n){return n.account})).accountData,N=null===L||void 0===L||null===(n=L.paths)||void 0===n||null===(e=n.khoChaLua)||void 0===e?void 0:e.edit,k=Object(M.a)({Instance:m.a,onPending:T.d,addSelectedId:T.a,isEdit:N});c.a.useEffect((function(){return t(Object(T.c)()),function(){Object(y.i)("khoChaLua")}}),[]);var K=c.a.useMemo((function(){return Object.values(p).map((function(n){var e=n.soLuongTonKho,t=void 0===e?0:e,a=n.giaNhapTonKho,i=void 0===a?0:a,c=(null===g||void 0===g?void 0:g[null===n||void 0===n?void 0:n.id])||{},u=Math.round(t*i);return Object(o.a)(Object(o.a)(Object(o.a)({},c),n),{},{thanhTienTonKho:u})})).reduce((function(n,e){return Object(o.a)(Object(o.a)({},n),{},Object(a.a)({},e.id,e))}),{})}),[g,p]);return Object(W.c)("div",{className:"khoChaLua-page",css:s.a,children:[Object(W.b)(b.b,{className:"tabs",options:h,activeKey:C?"aside":"",onTabClick:function(n){if("add"===n&&N){if(!N)return Object(on.j)();var e=new m.a;t(Object(l.c)({modalId:gn,data:e.initData}))}else"aside"===n?t(Object(d.b)({tagPageId:gn})):"taiExcel"===n&&t(Object(r.b)({tableId:gn,constants:f,fileSheet:"khoChaLuaSheet",fileName:"khoChaLuaName"}))}}),Object(W.c)("div",{className:"tabs-main",style:{marginTop:"10px"},children:[C&&Object(W.b)(sn,{}),Object(W.b)("div",{className:"aside-main",children:Object(W.b)(v.a,{isEdit:N,onCallbackDataSource:function(n){return Object(On.a)("tenMatHang",n)},constants:f,actions:k,datas:K,loading:O,modalId:gn,expandable:{expandedRowRender:function(n){return Object(W.b)("div",{children:n.id})},expandRowByClick:!1},isSelection:!0,pagination:!0,pageSize:j,onChange:function(n){t(Object(T.e)(n.pageSize))},onRow:function(n){return{onClick:function(){N&&t(Object(l.c)({modalId:gn,data:n}))}}},summary:function(n){return Object(W.b)(pn,{pageData:n})}})})]})]})}}}]);